<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Royal Touch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="rt-body">

  <!-- ======= Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ Ù…Ø¹ Ø§Ù„Ù„ÙˆÙ‚Ùˆ ======= -->
  <header class="rt-header">
    <div class="rt-header-inner">
      <div class="rt-logo-wrap">
        <img src="logo-royal-touch.png" alt="Royal Touch Logo" class="rt-logo" />
        <div class="rt-logo-text">
          <h1>Royal Touch</h1>
          <p>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…ØªØ¬Ø± Ø§Ù„Ù„Ù…Ø³Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ©</p>
        </div>
      </div>
    </div>
  </header>

  <main class="rt-main">

    <!-- ======= Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø£Ø¯Ù…Ù† ======= -->
    <section id="admin-login-section" class="rt-card rt-auth-card">
      <h2 class="rt-section-title">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
      <p class="rt-muted">
        Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….
        <br />
        (Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©: Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… <strong>admin</strong> ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        <strong>admin123</strong> Ø«Ù… ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡Ø§ Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø©)
      </p>

      <form id="admin-login-form" class="rt-form">
        <div class="rt-form-group">
          <label for="admin-username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
          <input type="text" id="admin-username" class="rt-input" placeholder="Ù…Ø«Ø§Ù„: admin" required />
        </div>

        <div class="rt-form-group">
          <label for="admin-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <input type="password" id="admin-password" class="rt-input" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
        </div>

        <button type="submit" class="rt-btn rt-btn-gold rt-btn-full">
          Ø¯Ø®ÙˆÙ„
        </button>

        <p id="login-error" class="rt-error" style="display:none;"></p>
      </form>
    </section>

    <!-- ======= Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ======= -->
    <section id="admin-dashboard" class="rt-dashboard" style="display:none;">

      <!-- Ø´Ø±ÙŠØ· Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø© -->
      <div class="rt-dashboard-top">
        <div>
          <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="admin-name-display">Ø£Ø¯Ù…Ù†</span> ğŸ‘‘</h2>
          <p class="rt-muted">ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù† Ù‡Ù†Ø§ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„Ø¹Ø±ÙˆØ¶ØŒ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†.</p>
        </div>
        <button id="logout-btn" class="rt-btn rt-btn-outline">
          ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        </button>
      </div>

      <!-- ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
      <section class="rt-section">
        <h3 class="rt-section-title">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
        <div class="rt-stats-grid">
          <div class="rt-card rt-stat-card">
            <span class="rt-stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
            <span id="stat-products" class="rt-stat-value">0</span>
          </div>
          <div class="rt-card rt-stat-card">
            <span class="rt-stat-label">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙØ¹Ù‘Ø§Ù„Ø©</span>
            <span id="stat-offers" class="rt-stat-value">0</span>
          </div>
          <div class="rt-card rt-stat-card">
            <span class="rt-stat-label">Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</span>
            <span id="stat-categories" class="rt-stat-value">0</span>
          </div>
          <div class="rt-card rt-stat-card">
            <span class="rt-stat-label">Ø·Ù„Ø¨Ø§Øª (ØªØ¬Ø±ÙŠØ¨ÙŠØ©)</span>
            <span id="stat-orders" class="rt-stat-value">0</span>
          </div>
        </div>
      </section>

      <!-- ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù† -->
      <section class="rt-section">
        <h3 class="rt-section-title">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†</h3>
        <form id="password-form" class="rt-form rt-grid-3">
          <div class="rt-form-group">
            <label for="current-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label>
            <input type="password" id="current-password" class="rt-input" required />
          </div>
          <div class="rt-form-group">
            <label for="new-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
            <input type="password" id="new-password" class="rt-input" required />
          </div>
          <div class="rt-form-group">
            <label for="confirm-password">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
            <input type="password" id="confirm-password" class="rt-input" required />
          </div>
          <button type="submit" class="rt-btn rt-btn-gold">
            Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
          </button>
          <p id="password-message" class="rt-success" style="display:none;"></p>
        </form>
      </section>

      <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª -->
      <section class="rt-section">
        <h3 class="rt-section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù (Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª)</h3>
        <form id="category-form" class="rt-form rt-grid-2">
          <div class="rt-form-group">
            <label for="category-name">Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù</label>
            <input type="text" id="category-name" class="rt-input" placeholder="Ù…Ø«Ø§Ù„: ÙØ³Ø§ØªÙŠÙ† Ø¨Ù†Ø§Øª" required />
          </div>
          <button type="submit" class="rt-btn rt-btn-gold">
            Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù
          </button>
        </form>

        <ul id="category-list" class="rt-pill-list"></ul>
      </section>

      <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª + Ø§Ù„Ø¹Ø±ÙˆØ¶ -->
      <section class="rt-section">
        <h3 class="rt-section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶</h3>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬ -->
        <form id="product-form" class="rt-form rt-grid-4">
          <div class="rt-form-group">
            <label for="product-name">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
            <input type="text" id="product-name" class="rt-input" required />
          </div>

          <div class="rt-form-group">
            <label for="product-category">Ø§Ù„ØµÙ†Ù</label>
            <select id="product-category" class="rt-input"></select>
          </div>

          <div class="rt-form-group">
            <label for="product-price">Ø§Ù„Ø³Ø¹Ø±</label>
            <input type="number" id="product-price" class="rt-input" min="0" step="0.01" required />
          </div>

          <div class="rt-form-group">
            <label for="product-offer-price">Ø³Ø¹Ø± Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input type="number" id="product-offer-price" class="rt-input" min="0" step="0.01" />
          </div>

          <div class="rt-form-group rt-full-width">
            <label for="product-description">Ø§Ù„ÙˆØµÙ</label>
            <textarea id="product-description" class="rt-input" rows="2"></textarea>
          </div>

          <div class="rt-form-group">
            <label for="product-image-url">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input type="text" id="product-image-url" class="rt-input" placeholder="https://..." />
          </div>

          <div class="rt-form-group">
            <label for="product-in-offer">ÙÙŠ Ø¹Ø±Ø¶ØŸ</label>
            <select id="product-in-offer" class="rt-input">
              <option value="no">Ù„Ø§</option>
              <option value="yes">Ù†Ø¹Ù…</option>
            </select>
          </div>

          <input type="hidden" id="editing-product-id" value="" />

          <button type="submit" class="rt-btn rt-btn-gold">
            Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬
          </button>
          <button type="button" id="product-form-reset" class="rt-btn rt-btn-ghost">
            Ø¥Ù„ØºØ§Ø¡ / Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
          </button>

          <p class="rt-muted rt-full-width">
            â• Ù…Ù† Ù‡Ù†Ø§ ØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ØŒ Ø£Ùˆ ØªØ¹Ø¯Ù‘Ù„ Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø£Ùˆ ØªØ¶ÙŠÙÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±ÙˆØ¶.
          </p>
        </form>

        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div class="rt-table-wrapper">
          <table class="rt-table">
            <thead>
              <tr>
                <th>Ø§Ù„Ø§Ø³Ù…</th>
                <th>Ø§Ù„ØµÙ†Ù</th>
                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                <th>Ø³Ø¹Ø± Ø§Ù„Ø¹Ø±Ø¶</th>
                <th>Ø¹Ø±Ø¶ØŸ</th>
                <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody id="products-table-body">
              <!-- ÙŠÙ…ØªÙ„Ø¦ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ -->
      <section class="rt-section">
        <h3 class="rt-section-title">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¹Ù…ÙŠÙ„</h3>
        <p class="rt-muted">
          Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¨Ø¹Ø« Ø±Ø³Ø§Ù„Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù€ WhatsApp Business Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…
          <strong>0917040244</strong> ØªØ­ØªÙˆÙŠ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨.
        </p>

        <form id="whatsapp-form" class="rt-form rt-grid-3">
          <div class="rt-form-group">
            <label for="wa-customer-name">Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†Ø©</label>
            <input type="text" id="wa-customer-name" class="rt-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†Ø©" required />
          </div>
          <div class="rt-form-group">
            <label for="wa-order-id">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
            <input type="text" id="wa-order-id" class="rt-input" placeholder="Ù…Ø«Ø§Ù„: RT-00015" required />
          </div>
          <div class="rt-form-group">
            <label for="wa-order-total">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº</label>
            <input type="number" id="wa-order-total" class="rt-input" min="0" step="0.01" required />
          </div>

          <button type="submit" class="rt-btn rt-btn-whatsapp">
            Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§ØªØ³Ø§Ø¨
          </button>
        </form>
      </section>

    </section>
  </main>

  <!-- ======= Ø³ÙƒØ±Ø¨Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (LocalStorage + ÙˆØ§ØªØ³Ø§Ø¨) ======= -->
  <script>
    // ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† (ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­) =====
    const ADMIN_USER_KEY = 'rt_admin_username';
    const ADMIN_PASS_KEY = 'rt_admin_password';

    // ØªØ¹ÙŠÙŠÙ† Ù‚ÙŠÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
    function ensureDefaultAdmin() {
      if (!localStorage.getItem(ADMIN_USER_KEY)) {
        localStorage.setItem(ADMIN_USER_KEY, 'admin');
      }
      if (!localStorage.getItem(ADMIN_PASS_KEY)) {
        localStorage.setItem(ADMIN_PASS_KEY, 'admin123');
      }
    }

    ensureDefaultAdmin();

    const loginSection = document.getElementById('admin-login-section');
    const dashboardSection = document.getElementById('admin-dashboard');
    const adminNameDisplay = document.getElementById('admin-name-display');
    const loginForm = document.getElementById('admin-login-form');
    const loginError = document.getElementById('login-error');
    const logoutBtn = document.getElementById('logout-btn');

    // ===== ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ =====
    loginForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const username = document.getElementById('admin-username').value.trim();
      const password = document.getElementById('admin-password').value.trim();

      const storedUser = localStorage.getItem(ADMIN_USER_KEY);
      const storedPass = localStorage.getItem(ADMIN_PASS_KEY);

      if (username === storedUser && password === storedPass) {
        loginError.style.display = 'none';
        loginSection.style.display = 'none';
        dashboardSection.style.display = 'block';
        adminNameDisplay.textContent = username;
      } else {
        loginError.textContent = 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©.';
        loginError.style.display = 'block';
      }
    });

    // ===== ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ =====
    logoutBtn.addEventListener('click', function () {
      dashboardSection.style.display = 'none';
      loginSection.style.display = 'block';
      document.getElementById('admin-password').value = '';
    });

    // ===== ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù† =====
    const passwordForm = document.getElementById('password-form');
    const passwordMessage = document.getElementById('password-message');

    passwordForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const current = document.getElementById('current-password').value.trim();
      const newPass = document.getElementById('new-password').value.trim();
      const confirm = document.getElementById('confirm-password').value.trim();
      const storedPass = localStorage.getItem(ADMIN_PASS_KEY);

      if (current !== storedPass) {
        passwordMessage.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©.';
        passwordMessage.className = 'rt-error';
        passwordMessage.style.display = 'block';
        return;
      }

      if (!newPass || newPass.length < 6) {
        passwordMessage.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.';
        passwordMessage.className = 'rt-error';
        passwordMessage.style.display = 'block';
        return;
      }

      if (newPass !== confirm) {
        passwordMessage.textContent = 'ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚.';
        passwordMessage.className = 'rt-error';
        passwordMessage.style.display = 'block';
        return;
      }

      localStorage.setItem(ADMIN_PASS_KEY, newPass);
      passwordMessage.textContent = 'ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­ âœ…';
      passwordMessage.className = 'rt-success';
      passwordMessage.style.display = 'block';

      passwordForm.reset();
    });

    // ====== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù ======
    const CATEGORY_KEY = 'rt_categories';
    const categoryForm = document.getElementById('category-form');
    const categoryInput = document.getElementById('category-name');
    const categoryList = document.getElementById('category-list');
    const productCategorySelect = document.getElementById('product-category');

    function loadCategories() {
      const raw = localStorage.getItem(CATEGORY_KEY);
      return raw ? JSON.parse(raw) : [];
    }

    function saveCategories(categories) {
      localStorage.setItem(CATEGORY_KEY, JSON.stringify(categories));
      updateCategoryUI();
    }

    function updateCategoryUI() {
      const categories = loadCategories();
      categoryList.innerHTML = '';
      productCategorySelect.innerHTML = '';

      categories.forEach((cat, index) => {
        // Ø¹Ù†ØµØ± ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù
        const li = document.createElement('li');
        li.className = 'rt-pill';
        li.textContent = cat;

        const removeBtn = document.createElement('button');
        removeBtn.className = 'rt-pill-remove';
        removeBtn.textContent = 'âœ•';
        removeBtn.addEventListener('click', () => {
          const updated = categories.filter((_, i) => i !== index);
          saveCategories(updated);
        });

        li.appendChild(removeBtn);
        categoryList.appendChild(li);

        // Ø®ÙŠØ§Ø± ÙÙŠ select Ø§Ù„ØµÙ†Ù
        const option = document.createElement('option');
        option.value = cat;
        option.textContent = cat;
        productCategorySelect.appendChild(option);
      });

      // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª
      document.getElementById('stat-categories').textContent = categories.length;
    }

    categoryForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const name = categoryInput.value.trim();
      if (!name) return;

      const categories = loadCategories();
      if (!categories.includes(name)) {
        categories.push(name);
        saveCategories(categories);
      }
      categoryInput.value = '';
    });

    // ====== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ ======
    const PRODUCTS_KEY = 'rt_products';
    const productForm = document.getElementById('product-form');
    const productsTableBody = document.getElementById('products-table-body');
    const resetProductBtn = document.getElementById('product-form-reset');
    const editingProductIdInput = document.getElementById('editing-product-id');

    function loadProducts() {
      const raw = localStorage.getItem(PRODUCTS_KEY);
      return raw ? JSON.parse(raw) : [];
    }

    function saveProducts(products) {
      localStorage.setItem(PRODUCTS_KEY, JSON.stringify(products));
      updateProductsUI();
    }

    function updateProductsUI() {
      const products = loadProducts();
      productsTableBody.innerHTML = '';

      let offersCount = 0;

      products.forEach((p) => {
        if (p.inOffer === 'yes') offersCount++;

        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${p.name}</td>
          <td>${p.category || '-'}</td>
          <td>${p.price.toFixed(2)} Ø¯.Ù„</td>
          <td>${p.offerPrice ? p.offerPrice.toFixed(2) + ' Ø¯.Ù„' : '-'}</td>
          <td>${p.inOffer === 'yes' ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}</td>
          <td>
            <button class="rt-btn rt-btn-xs rt-btn-ghost" data-action="edit">ØªØ¹Ø¯ÙŠÙ„</button>
            <button class="rt-btn rt-btn-xs rt-btn-danger" data-action="delete">Ø­Ø°Ù</button>
          </td>
        `;

        // Ø£Ø²Ø±Ø§Ø± ØªØ¹Ø¯ÙŠÙ„ / Ø­Ø°Ù
        tr.querySelector('[data-action="edit"]').addEventListener('click', () => {
          fillProductFormForEdit(p.id);
        });

        tr.querySelector('[data-action="delete"]').addEventListener('click', () => {
          if (confirm('Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) {
            const updated = products.filter((x) => x.id !== p.id);
            saveProducts(updated);
          }
        });

        productsTableBody.appendChild(tr);
      });

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      document.getElementById('stat-products').textContent = products.length;
      document.getElementById('stat-offers').textContent = offersCount;
    }

    function fillProductFormForEdit(id) {
      const products = loadProducts();
      const p = products.find((x) => x.id === id);
      if (!p) return;

      document.getElementById('product-name').value = p.name;
      document.getElementById('product-category').value = p.category || '';
      document.getElementById('product-price').value = p.price;
      document.getElementById('product-offer-price').value = p.offerPrice || '';
      document.getElementById('product-description').value = p.description || '';
      document.getElementById('product-image-url').value = p.imageUrl || '';
      document.getElementById('product-in-offer').value = p.inOffer || 'no';
      editingProductIdInput.value = p.id;
    }

    productForm.addEventListener('submit', function (e) {
      e.preventDefault();

      const name = document.getElementById('product-name').value.trim();
      const category = document.getElementById('product-category').value;
      const price = parseFloat(document.getElementById('product-price').value || '0');
      const offerPriceRaw = document.getElementById('product-offer-price').value;
      const offerPrice = offerPriceRaw ? parseFloat(offerPriceRaw) : null;
      const description = document.getElementById('product-description').value.trim();
      const imageUrl = document.getElementById('product-image-url').value.trim();
      const inOffer = document.getElementById('product-in-offer').value;
      const editingId = editingProductIdInput.value;

      if (!name) return;

      const products = loadProducts();

      if (editingId) {
        // ØªØ¹Ø¯ÙŠÙ„
        const index = products.findIndex((x) => x.id === editingId);
        if (index > -1) {
          products[index] = {
            ...products[index],
            name,
            category,
            price,
            offerPrice,
            description,
            imageUrl,
            inOffer
          };
        }
      } else {
        // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯
        products.push({
          id: 'p_' + Date.now(),
          name,
          category,
          price,
          offerPrice,
          description,
          imageUrl,
          inOffer
        });
      }

      saveProducts(products);
      productForm.reset();
      editingProductIdInput.value = '';
    });

    resetProductBtn.addEventListener('click', function () {
      productForm.reset();
      editingProductIdInput.value = '';
    });

    // ===== Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ =====
    const whatsappForm = document.getElementById('whatsapp-form');
    whatsappForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const name = document.getElementById('wa-customer-name').value.trim();
      const orderId = document.getElementById('wa-order-id').value.trim();
      const total = document.getElementById('wa-order-total').value.trim();

      const msg =
        'Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ØªØ¬Ø± Royal Touch %0A' +
        'Ø§Ù„Ø²Ø¨ÙˆÙ†Ø©: ' + name + '%0A' +
        'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ' + orderId + '%0A' +
        'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ' + total + ' Ø¯.Ù„';

      const phone = '218917040244'; // ÙˆØ§ØªØ³Ø§Ø¨ Ø£Ø¹Ù…Ø§Ù„
      const url = 'https://wa.me/' + phone + '?text=' + msg;

      window.open(url, '_blank');
    });

    // ===== ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø© =====
    function initDashboard() {
      updateCategoryUI();
      updateProductsUI();
    }

    // Ù„Ùˆ Ø­Ø§Ø¨Ø¨ ØªØ¬Ø±Ø¨ Ø¨Ø¯ÙˆÙ† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ØŒ Ø§ÙØ¹Ù„ Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ:
    // dashboardSection.style.display = 'block'; loginSection.style.display = 'none';

    initDashboard();
  </script>
</body>
</html>
